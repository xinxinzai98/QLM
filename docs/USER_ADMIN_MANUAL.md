# 用户管理员手册

**系统名称**: 清绿氢能物料管理系统 (QingGreen Hydrogen Energy Material Management System)  
**版本**: 1.0.0  
**最后更新**: 2025年12月

---

## 目录

1. [系统概述](#系统概述)
2. [快速开始](#快速开始)
3. [登录与权限](#登录与权限)
4. [功能模块操作指南](#功能模块操作指南)
5. [常见问题与故障排除](#常见问题与故障排除)
6. [系统维护](#系统维护)

---

## 系统概述

### 系统简介

清绿氢能物料管理系统是一个基于Web的物料管理解决方案，支持化学物料和金属物料的完整生命周期管理。系统提供物料信息管理、出入库流程、审批工作流、物料盘点、数据分析和操作审计等功能。

### 主要功能

- ✅ **物料管理**: 物料的增删改查、搜索筛选、批量操作
- ✅ **出入库管理**: 出入库单创建、审批流程、库存自动更新
- ✅ **物料盘点**: 盘点任务创建、实际数量录入、差异分析、报告生成
- ✅ **数据分析**: 仪表盘统计、图表展示、趋势分析
- ✅ **用户管理**: 用户账号管理、角色分配、权限控制
- ✅ **操作审计**: 完整的操作日志记录
- ✅ **消息通知**: 待办任务通知、系统公告

### 系统要求

**浏览器要求：**
- Chrome 90+（推荐）
- Firefox 88+
- Edge 90+
- Safari 14+

**网络要求：**
- 稳定的网络连接
- 建议使用Chrome浏览器以获得最佳体验

---

## 快速开始

### 访问系统

1. 打开浏览器，访问系统地址（例如：`http://localhost:5173`）
2. 系统会自动跳转到登录页面

### 默认账号

**系统管理员：**
- 用户名：`admin`
- 密码：`admin123`

**注意：** 首次登录后，请立即修改默认密码！

---

## 登录与权限

### 登录系统

1. 在登录页面输入用户名和密码
2. 点击"登录"按钮
3. 登录成功后，系统会根据您的角色自动跳转到相应页面：
   - **系统管理员/库存管理员**: 跳转到仪表盘
   - **普通人员**: 跳转到物料管理页面

### 用户角色与权限

系统定义了三种角色，每种角色具有不同的权限：

#### 1. 系统管理员 (system_admin)

**权限范围：**
- ✅ 所有功能权限
- ✅ 用户管理（新增、编辑、删除用户）
- ✅ 物料管理（完整CRUD）
- ✅ 出入库审批
- ✅ 物料盘点
- ✅ 查看所有数据
- ✅ 系统设置

**可访问的页面：**
- 仪表盘
- 物料管理
- 出入库管理
- 物料盘点
- 用户管理
- 操作日志
- 个人中心
- 系统设置

#### 2. 库存管理员 (inventory_manager)

**权限范围：**
- ✅ 物料管理（完整CRUD）
- ✅ 出入库审批
- ✅ 物料盘点
- ✅ 查看统计数据
- ❌ 用户管理（无权限）

**可访问的页面：**
- 仪表盘
- 物料管理
- 出入库管理
- 物料盘点
- 操作日志
- 个人中心

#### 3. 普通人员 (regular_user)

**权限范围：**
- ✅ 创建出入库单
- ✅ 查看物料信息
- ✅ 查看个人相关数据
- ❌ 物料管理（无权限）
- ❌ 审批权限（无权限）
- ❌ 用户管理（无权限）

**可访问的页面：**
- 物料管理（仅查看）
- 出入库管理（仅创建）
- 个人中心

### 登出系统

1. 点击右上角用户头像
2. 选择"退出登录"
3. 系统会清除登录信息并跳转到登录页面

---

## 功能模块操作指南

### 1. 仪表盘

**访问路径：** 登录后自动跳转（系统管理员/库存管理员）

**功能说明：**
- 查看系统统计数据（物料总数、待审批单、今日出入库、低库存物料）
- 查看物料分类统计图表（饼图）
- 查看最近30天出入库趋势图表（折线图）
- 查看低库存物料列表
- 查看待审批单列表

**操作步骤：**

1. **查看统计数据**
   - 页面顶部显示4个统计卡片
   - 点击卡片可跳转到相关页面

2. **查看图表**
   - 物料分类统计：显示化学物料和金属物料的分布
   - 出入库趋势：显示最近30天的出入库趋势

3. **查看低库存物料**
   - 表格显示库存低于最小库存的物料
   - 可点击物料名称查看详情

4. **查看待审批单**
   - 表格显示待审批的出入库单
   - 可点击"审批"按钮进行审批操作

### 2. 物料管理

**访问路径：** 侧边栏 → 物料管理

**功能说明：**
- 物料的增删改查
- 搜索和筛选
- 批量操作（批量删除、批量导出）

**操作步骤：**

#### 2.1 查看物料列表

1. 进入物料管理页面
2. 系统自动加载物料列表（分页显示）
3. 使用搜索框搜索物料（支持编码、名称搜索）
4. 使用筛选器筛选物料（按类别、状态筛选）

#### 2.2 新增物料

1. 点击"新增物料"按钮
2. 填写物料信息：
   - **物料编码**：必填，唯一标识
   - **物料名称**：必填
   - **类别**：选择"化学物料"或"金属物料"
   - **单位**：必填（如：kg、L、个等）
   - **当前库存**：必填，数字
   - **最小库存**：必填，数字（用于低库存预警）
   - **规格**：可选
   - **供应商**：可选
   - **备注**：可选
3. 点击"确定"按钮提交
4. 系统会验证数据并创建物料

#### 2.3 编辑物料

1. 在物料列表中，点击要编辑的物料行的"编辑"按钮
2. 在弹出的对话框中修改物料信息
3. 点击"确定"按钮保存修改

**注意：** 物料编码不能修改

#### 2.4 删除物料

1. 在物料列表中，点击要删除的物料行的"删除"按钮
2. 系统会弹出确认对话框
3. 点击"确定"确认删除

**注意：** 
- 如果物料有相关的出入库记录，不能删除
- 删除操作不可恢复，请谨慎操作

#### 2.5 批量操作

**批量删除：**
1. 勾选要删除的物料（可多选）
2. 点击"批量删除"按钮
3. 确认删除操作

**批量导出：**
1. 勾选要导出的物料（可多选）
2. 点击"批量导出"按钮
3. 系统会生成Excel文件并下载

### 3. 出入库管理

**访问路径：** 侧边栏 → 出入库管理

**功能说明：**
- 创建出入库单
- 审批出入库单（库存管理员/系统管理员）
- 取消出入库单
- 查看出入库历史

**操作步骤：**

#### 3.1 创建出入库单

1. 点击"创建出入库单"按钮
2. 填写出入库单信息：
   - **类型**：选择"入库"或"出库"
   - **物料**：从下拉列表选择物料（显示当前库存）
   - **数量**：必填，数字
   - **单价**：可选，数字（用于计算总金额）
   - **备注**：可选
3. 点击"确定"按钮提交
4. 系统会创建出入库单，状态为"待审批"

**注意：**
- 出库时，系统会检查库存是否充足
- 如果库存不足，系统会提示错误

#### 3.2 审批出入库单（库存管理员/系统管理员）

1. 在出入库单列表中，找到状态为"待审批"的单据
2. 点击"审批"按钮
3. 在弹出的对话框中：
   - 选择操作："批准"或"拒绝"
   - 输入审批备注（可选）
4. 点击"确定"按钮提交审批

**审批结果：**
- **批准**：系统会更新物料库存，单据状态变为"已批准"
- **拒绝**：单据状态变为"已拒绝"，库存不更新

#### 3.3 取消出入库单

1. 在出入库单列表中，找到状态为"待审批"的单据
2. 点击"取消"按钮
3. 确认取消操作
4. 单据状态变为"已取消"

**注意：** 只有"待审批"状态的单据可以取消

#### 3.4 查看出入库历史

1. 使用筛选器筛选出入库单：
   - 按状态筛选（待审批、已批准、已拒绝、已取消）
   - 按类型筛选（入库、出库）
   - 按日期范围筛选
2. 点击出入库单可查看详情

### 4. 物料盘点

**访问路径：** 侧边栏 → 物料盘点（库存管理员/系统管理员）

**功能说明：**
- 创建盘点任务
- 录入实际数量
- 生成盘点报告
- 更新库存（可选）

**操作步骤：**

#### 4.1 创建盘点任务

1. 点击"创建盘点任务"按钮
2. 填写任务信息：
   - **任务名称**：必填
   - **开始日期**：必填
   - **结束日期**：必填
   - **物料列表**：选择要盘点的物料（可多选）
3. 点击"确定"按钮提交
4. 系统会创建盘点任务，状态为"草稿"

#### 4.2 录入实际数量

1. 在盘点任务列表中，点击"查看/编辑"按钮
2. 在盘点明细表格中，录入每个物料的实际数量
3. 系统会自动计算差异（实际数量 - 账面数量）
4. 差异类型：
   - **正常**：差异为0
   - **盘盈**：实际数量 > 账面数量
   - **盘亏**：实际数量 < 账面数量

#### 4.3 完成盘点任务

1. 录入完所有物料的实际数量后，点击"完成"按钮
2. 在弹出的对话框中：
   - 选择是否更新库存（勾选则更新，不勾选则不更新）
   - 输入备注（可选）
3. 点击"确定"按钮提交
4. 系统会生成盘点报告，任务状态变为"已完成"

**盘点报告包含：**
- 盘点任务信息
- 盘点明细（账面数量、实际数量、差异）
- 差异汇总（盘盈、盘亏、正常）

### 5. 用户管理（仅系统管理员）

**访问路径：** 侧边栏 → 用户管理

**功能说明：**
- 新增用户
- 编辑用户信息
- 删除用户
- 搜索和筛选用户

**操作步骤：**

#### 5.1 新增用户

1. 点击"新增用户"按钮
2. 填写用户信息：
   - **用户名**：必填，唯一标识
   - **密码**：必填，至少6位
   - **角色**：选择"系统管理员"、"库存管理员"或"普通人员"
   - **真实姓名**：可选
   - **邮箱**：可选
3. 点击"确定"按钮提交

#### 5.2 编辑用户

1. 在用户列表中，点击要编辑的用户行的"编辑"按钮
2. 在弹出的对话框中修改用户信息
3. 点击"确定"按钮保存修改

**注意：**
- 修改密码时，如果不填写新密码，则保持原密码不变
- 不能删除自己

#### 5.3 删除用户

1. 在用户列表中，点击要删除的用户行的"删除"按钮
2. 系统会弹出确认对话框
3. 点击"确定"确认删除

**注意：** 
- 不能删除自己
- 删除操作不可恢复，请谨慎操作

### 6. 个人中心

**访问路径：** 右上角用户头像 → 个人中心

**功能说明：**
- 查看个人信息
- 修改个人信息
- 上传头像
- 修改密码

**操作步骤：**

#### 6.1 查看个人信息

1. 进入个人中心页面
2. 左侧显示当前头像
3. 右侧显示个人信息表单

#### 6.2 修改个人信息

1. 在个人信息表单中修改：
   - **真实姓名**
   - **邮箱**
2. 点击"保存"按钮保存修改

#### 6.3 上传头像

1. 点击头像下方的"上传头像"按钮
2. 选择图片文件（支持JPG、PNG格式，建议大小不超过2MB）
3. 系统会自动上传并更新头像

#### 6.4 删除头像

1. 点击头像下方的"删除头像"按钮
2. 确认删除操作
3. 系统会删除头像，恢复默认头像

#### 6.5 修改密码

1. 在个人信息表单中，填写"新密码"字段
2. 点击"保存"按钮保存修改

**注意：** 密码至少6位

### 7. 操作日志

**访问路径：** 侧边栏 → 操作日志

**功能说明：**
- 查看系统操作记录
- 筛选操作日志（按模块、操作、用户、日期）

**操作步骤：**

1. 进入操作日志页面
2. 使用筛选器筛选日志：
   - **模块**：选择模块（物料管理、出入库管理、用户管理等）
   - **操作**：选择操作类型（创建、更新、删除等）
   - **用户**：选择用户（系统管理员可见）
   - **日期范围**：选择开始日期和结束日期
3. 点击"搜索"按钮执行筛选
4. 表格显示符合条件的操作日志

**日志信息包含：**
- 操作时间
- 操作用户
- 操作模块
- 操作类型
- 操作对象
- 操作描述

### 8. 系统设置

**访问路径：** 侧边栏 → 系统设置

**功能说明：**
- 切换主题（浅色/深色）
- 查看系统信息

**操作步骤：**

1. 进入系统设置页面
2. **切换主题**：
   - 选择"浅色主题"或"深色主题"
   - 系统会立即应用主题
3. **查看系统信息**：
   - 系统版本
   - 技术栈信息

### 9. 帮助中心

**访问路径：** 侧边栏 → 帮助中心

**功能说明：**
- 查看系统使用帮助
- 查看常见问题

**操作步骤：**

1. 进入帮助中心页面
2. 浏览帮助文档
3. 查看常见问题解答

### 10. 全局搜索

**访问路径：** 快捷键 `Ctrl+K` 或点击顶部搜索图标

**功能说明：**
- 搜索物料
- 搜索用户
- 搜索出入库单

**操作步骤：**

1. 按 `Ctrl+K` 打开搜索对话框
2. 输入搜索关键词
3. 系统会自动搜索并显示结果
4. 点击搜索结果可跳转到相关页面

**搜索提示：**
- 支持模糊搜索
- 可以按类型筛选（全部、物料、用户、出入库单）

### 11. 消息中心

**访问路径：** 顶部通知图标

**功能说明：**
- 查看待办任务
- 查看系统公告
- 标记通知为已读

**操作步骤：**

1. 点击顶部通知图标
2. 在弹出的对话框中：
   - **全部**：查看所有通知
   - **待办**：查看待办任务（如待审批单）
   - **系统公告**：查看系统公告
3. 点击通知可跳转到相关页面
4. 点击"全部标记已读"按钮可标记所有通知为已读

---

## 常见问题与故障排除

### 1. 登录问题

#### 问题：忘记密码

**解决方案：**
- 联系系统管理员重置密码
- 系统管理员可以在"用户管理"页面重置用户密码

#### 问题：登录后提示"登录已过期"

**解决方案：**
- 系统会自动尝试刷新Token
- 如果刷新失败，请重新登录
- 检查系统时间是否正确

#### 问题：无法登录，提示"用户名或密码错误"

**解决方案：**
- 检查用户名和密码是否正确
- 注意大小写
- 联系系统管理员确认账号状态

### 2. 权限问题

#### 问题：无法访问某个页面，提示"权限不足"

**解决方案：**
- 确认您的角色是否有权限访问该页面
- 联系系统管理员分配相应权限

#### 问题：无法执行某个操作，提示"权限不足"

**解决方案：**
- 确认您的角色是否有权限执行该操作
- 联系系统管理员分配相应权限

### 3. 数据问题

#### 问题：物料列表为空

**解决方案：**
- 检查是否有物料数据
- 检查筛选条件是否正确
- 尝试清除筛选条件

#### 问题：无法删除物料，提示"该物料有相关记录"

**解决方案：**
- 该物料有相关的出入库记录，不能删除
- 如需删除，请先删除相关记录（不推荐）

#### 问题：出库时提示"库存不足"

**解决方案：**
- 检查物料当前库存
- 减少出库数量
- 或先进行入库操作

### 4. 操作问题

#### 问题：提交表单时提示"验证失败"

**解决方案：**
- 检查必填字段是否已填写
- 检查数据格式是否正确（如数字、日期）
- 查看具体错误提示

#### 问题：上传头像失败

**解决方案：**
- 检查图片格式（支持JPG、PNG）
- 检查图片大小（建议不超过2MB）
- 检查网络连接

#### 问题：导出Excel失败

**解决方案：**
- 检查浏览器是否允许下载文件
- 检查是否有数据可导出
- 尝试刷新页面后重试

### 5. 系统问题

#### 问题：页面加载缓慢

**解决方案：**
- 检查网络连接
- 清除浏览器缓存
- 尝试刷新页面

#### 问题：页面显示异常

**解决方案：**
- 刷新页面
- 清除浏览器缓存
- 检查浏览器版本（建议使用Chrome 90+）
- 尝试使用其他浏览器

#### 问题：图表不显示

**解决方案：**
- 检查是否有数据
- 刷新页面
- 检查浏览器控制台是否有错误

### 6. 浏览器兼容性

**推荐浏览器：**
- Chrome 90+（最佳体验）
- Firefox 88+
- Edge 90+
- Safari 14+

**不支持的浏览器：**
- Internet Explorer（已停止支持）

---

## 系统维护

### 数据备份

**建议：**
- 定期备份数据库文件（`backend/mms.db`）
- 备份用户上传的头像文件（`backend/uploads/avatars/`）

**备份方法：**
1. 停止系统服务
2. 复制数据库文件到备份目录
3. 复制上传文件目录到备份目录
4. 重新启动系统服务

### 系统更新

**更新步骤：**
1. 备份当前数据和文件
2. 下载新版本
3. 停止系统服务
4. 替换系统文件
5. 运行数据库迁移（如有）
6. 重新启动系统服务
7. 验证系统功能

### 日志查看

**操作日志：**
- 在"操作日志"页面查看系统操作记录
- 可用于审计和故障排查

**系统日志：**
- 后端日志：查看服务器控制台输出
- 前端日志：查看浏览器控制台（F12）

---

## 联系支持

如遇到无法解决的问题，请联系系统管理员或技术支持团队。

**技术支持信息：**
- 系统版本：1.0.0
- 最后更新：2025年12月

---

**文档版本**: 1.0.0  
**最后更新**: 2025年12月  
**维护者**: 开发团队




