# Gitåˆå¹¶å†²çªä¿®å¤æŒ‡å—

**é—®é¢˜æè¿°**ï¼šECSæœåŠ¡å™¨ä¸Šæ‰§è¡Œæ›´æ–°è„šæœ¬æ—¶ï¼Œé‡åˆ°Gitåˆå¹¶å†²çªï¼Œæœ¬åœ°æœ‰æœªæäº¤çš„æ›´æ”¹ã€‚

---

## ğŸ” é—®é¢˜åˆ†æ

ä»é”™è¯¯ä¿¡æ¯å¯ä»¥çœ‹åˆ°ï¼š
1. **æœ¬åœ°æœ‰æœªæäº¤çš„æ›´æ”¹**ï¼š
   - `scripts/deploy_docker.sh` è¢«ä¿®æ”¹
   - `scripts/update.sh` è¢«ä¿®æ”¹

2. **æœ¬åœ°åˆ†æ”¯é¢†å…ˆè¿œç¨‹46ä¸ªæäº¤**ï¼ˆè¿™é€šå¸¸ä¸åº”è¯¥å‘ç”Ÿï¼‰

3. **Git pullå¤±è´¥**ï¼šå› ä¸ºæœ¬åœ°æ›´æ”¹ä¼šè¢«è¦†ç›–

---

## âœ… è§£å†³æ–¹æ¡ˆï¼ˆæ¨èï¼‰

### æ–¹æ¡ˆä¸€ï¼šå¼ºåˆ¶é‡ç½®åˆ°è¿œç¨‹ï¼ˆæœ€ç®€å•ï¼Œé€‚ç”¨äºç”Ÿäº§ç¯å¢ƒï¼‰

**âš ï¸ è­¦å‘Š**ï¼šè¿™ä¼šä¸¢å¤±æœ¬åœ°æœªæäº¤çš„æ›´æ”¹ã€‚å¦‚æœè¿™äº›æ›´æ”¹ä¸é‡è¦ï¼Œå¯ä»¥ä½¿ç”¨æ­¤æ–¹æ¡ˆã€‚

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd /opt/QLM

# 2. æŸ¥çœ‹å½“å‰çŠ¶æ€ï¼ˆç¡®è®¤è¦ä¸¢å¤±çš„æ›´æ”¹ï¼‰
git status
git diff scripts/deploy_docker.sh
git diff scripts/update.sh

# 3. å¦‚æœç¡®è®¤å¯ä»¥ä¸¢å¼ƒè¿™äº›æ›´æ”¹ï¼Œå¼ºåˆ¶é‡ç½®åˆ°è¿œç¨‹
git fetch origin main
git reset --hard origin/main

# 4. æ¸…ç†æœªè·Ÿè¸ªçš„æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
git clean -fd

# 5. éªŒè¯çŠ¶æ€
git status
# åº”è¯¥æ˜¾ç¤ºï¼šYour branch is up to date with 'origin/main'

# 6. é‡æ–°è¿è¡Œæ›´æ–°è„šæœ¬
./scripts/update.sh
```

---

### æ–¹æ¡ˆäºŒï¼šä¿å­˜æœ¬åœ°æ›´æ”¹åé‡ç½®ï¼ˆæ›´å®‰å…¨ï¼‰

å¦‚æœä½ ä¸ç¡®å®šæœ¬åœ°æ›´æ”¹æ˜¯å¦é‡è¦ï¼Œå¯ä»¥å…ˆä¿å­˜ï¼š

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd /opt/QLM

# 2. æŸ¥çœ‹æœ¬åœ°æ›´æ”¹
git diff scripts/deploy_docker.sh > /tmp/local_changes_deploy_docker.patch
git diff scripts/update.sh > /tmp/local_changes_update.patch

# 3. æŸ¥çœ‹æ›´æ”¹å†…å®¹
cat /tmp/local_changes_deploy_docker.patch
cat /tmp/local_changes_update.patch

# 4. å¦‚æœæ›´æ”¹ä¸é‡è¦ï¼Œåˆ é™¤è¡¥ä¸æ–‡ä»¶å¹¶é‡ç½®
rm /tmp/local_changes_*.patch
git fetch origin main
git reset --hard origin/main

# 5. å¦‚æœæ›´æ”¹é‡è¦ï¼Œå…ˆæäº¤ï¼ˆä¸æ¨èåœ¨ç”Ÿäº§ç¯å¢ƒï¼‰
# git add scripts/deploy_docker.sh scripts/update.sh
# git commit -m "ä¿å­˜æœ¬åœ°æ›´æ”¹"
# git pull origin main
```

---

### æ–¹æ¡ˆä¸‰ï¼šæ‰‹åŠ¨è§£å†³å†²çªï¼ˆæœ€å¤æ‚ï¼‰

å¦‚æœä½ éœ€è¦ä¿ç•™æœ¬åœ°æ›´æ”¹ï¼š

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd /opt/QLM

# 2. æš‚å­˜æœ¬åœ°æ›´æ”¹
git stash save "ä¿å­˜æœ¬åœ°æ›´æ”¹ $(date +%Y%m%d_%H%M%S)"

# 3. æ‹‰å–æœ€æ–°ä»£ç 
git fetch origin main
git pull origin main

# 4. æ¢å¤æœ¬åœ°æ›´æ”¹
git stash pop

# 5. å¦‚æœæœ‰å†²çªï¼Œæ‰‹åŠ¨è§£å†³
# git status  # æŸ¥çœ‹å†²çªæ–‡ä»¶
# ç¼–è¾‘å†²çªæ–‡ä»¶ï¼Œè§£å†³å†²çª
# git add <è§£å†³åçš„æ–‡ä»¶>
# git commit -m "è§£å†³åˆå¹¶å†²çª"
```

---

## ğŸš€ å¿«é€Ÿä¿®å¤å‘½ä»¤ï¼ˆä¸€é”®æ‰§è¡Œï¼‰

**å¦‚æœä½ ç¡®å®šå¯ä»¥ä¸¢å¼ƒæœ¬åœ°æ›´æ”¹ï¼Œç›´æ¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š**

```bash
cd /opt/QLM && \
git fetch origin main && \
git reset --hard origin/main && \
git clean -fd && \
echo "âœ… å·²é‡ç½®åˆ°è¿œç¨‹mainåˆ†æ”¯" && \
git status
```

ç„¶åé‡æ–°è¿è¡Œæ›´æ–°è„šæœ¬ï¼š
```bash
./scripts/update.sh
```

---

## ğŸ“‹ ä¿®å¤åéªŒè¯

```bash
# 1. æ£€æŸ¥GitçŠ¶æ€
git status
# åº”è¯¥æ˜¾ç¤ºï¼šYour branch is up to date with 'origin/main'

# 2. æ£€æŸ¥æœ¬åœ°æ›´æ”¹
git diff
# åº”è¯¥æ²¡æœ‰è¾“å‡º

# 3. æ£€æŸ¥è¿œç¨‹è¿æ¥
git remote -v
# åº”è¯¥æ˜¾ç¤ºï¼šorigin  https://github.com/xinxinzai98/QLM.git

# 4. é‡æ–°è¿è¡Œæ›´æ–°è„šæœ¬
./scripts/update.sh
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆæœ¬åœ°ä¼šé¢†å…ˆè¿œç¨‹46ä¸ªæäº¤ï¼Ÿ

**å¯èƒ½åŸå› **ï¼š
- ä¹‹å‰åœ¨æœåŠ¡å™¨ä¸Šç›´æ¥æäº¤äº†ä»£ç 
- æœ¬åœ°æœ‰æœªæ¨é€çš„æäº¤
- Gitå†å²è®°å½•æ··ä¹±

**è§£å†³æ–¹æ³•**ï¼šä½¿ç”¨ `git reset --hard origin/main` å¼ºåˆ¶åŒæ­¥åˆ°è¿œç¨‹ã€‚

### Q2: æœ¬åœ°æ›´æ”¹ä¼šè¢«æ°¸ä¹…ä¸¢å¤±å—ï¼Ÿ

**ç­”æ¡ˆ**ï¼šå¦‚æœä½¿ç”¨ `git reset --hard`ï¼Œæœ¬åœ°æœªæäº¤çš„æ›´æ”¹ä¼šä¸¢å¤±ã€‚ä½†ï¼š
- å¦‚æœè¿™äº›æ›´æ”¹ä¸é‡è¦ï¼ˆæ¯”å¦‚æ˜¯ä¸´æ—¶ä¿®æ”¹ï¼‰ï¼Œå¯ä»¥å®‰å…¨ä¸¢å¼ƒ
- å¦‚æœæ›´æ”¹é‡è¦ï¼Œå…ˆç”¨ `git diff > /tmp/changes.patch` ä¿å­˜

### Q3: å¦‚ä½•é¿å…ä»¥åå‡ºç°è¿™ä¸ªé—®é¢˜ï¼Ÿ

**å»ºè®®**ï¼š
1. **ä¸è¦åœ¨æœåŠ¡å™¨ä¸Šç›´æ¥ä¿®æ”¹ä»£ç **ï¼Œæ‰€æœ‰æ›´æ”¹åº”è¯¥åœ¨æœ¬åœ°å¼€å‘åæ¨é€åˆ°GitHub
2. **ä½¿ç”¨æ›´æ–°è„šæœ¬**ï¼Œå®ƒä¼šè‡ªåŠ¨å¤„ç†å†²çª
3. **å®šæœŸåŒæ­¥**ï¼š`git fetch origin main && git reset --hard origin/main`

---

## ğŸ”§ æ”¹è¿›æ›´æ–°è„šæœ¬ï¼ˆå¯é€‰ï¼‰

å¦‚æœç»å¸¸é‡åˆ°è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä¿®æ”¹ `scripts/update.sh`ï¼Œåœ¨æ‹‰å–ä»£ç å‰å¼ºåˆ¶é‡ç½®ï¼š

```bash
# åœ¨ pull_code() å‡½æ•°ä¸­æ·»åŠ ï¼š
git fetch origin main
git reset --hard origin/main
git clean -fd
```

ä½†è¿™æ ·ä¼šä¸¢å¤±æ‰€æœ‰æœ¬åœ°æ›´æ”¹ï¼Œè¯·è°¨æ…ä½¿ç”¨ã€‚

---

**æœ€åæ›´æ–°**ï¼š2024-01-XX

